var Je=Object.defineProperty;var Qe=(t,r,e)=>r in t?Je(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var se=(t,r,e)=>(Qe(t,typeof r!="symbol"?r+"":r,e),e);import{J as oe,n as ze,K as Re,d as c,y as q,S as _e,i as b,L as B,M as ae,N as Le,P as et,p as G,O as R,t as E,Q as Ke,R as Ge,o as be,m as ce,c as De,w as W,G as Z,u as fe,T as Ve,B as Y,U as tt,V as rt,W as at,F as Q,X as nt,Y as ie,Z as qe,I as $e,_ as Be,$ as He,z as Ue,a0 as we,a1 as Se,b as ot,v as st,a2 as lt,a3 as F,a4 as Pe,a5 as Fe,A as ge,a6 as it,a7 as Te,a8 as Ae,q as ct,a9 as le,aa as dt,ab as ut,ac as he,ad as gt,ae as vt,af as bt,ag as ft,j as mt}from"./index-B3l_s7jA.js";import{c as pt,g as ht,a as yt,b as xt,d as It,e as Ct,f as ve,I as $t,h as St,r as _t}from"./index-DzXQiS7B.js";import{z as ye,c as Dt,v as wt}from"./index-Cax71549.js";import{C as xe}from"./ConfigTitle-UIgRQej0.js";import{f as Ot}from"./global-3OfJXwwp.js";var Mt=oe("info-small","IconInfoSmall",[["path",{d:"M12 9h.01"}],["path",{d:"M11 12h1v4h1"}]]),Pt=oe("menu-order","IconMenuOrder",[["path",{d:"M4 10h16"}],["path",{d:"M4 14h16"}],["path",{d:"M9 18l3 3l3 -3"}],["path",{d:"M9 6l3 -3l3 3"}]]),Ft=oe("player-pause","IconPlayerPause",[["path",{d:"M6 5m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}],["path",{d:"M14 5m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v12a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z"}]]),Tt=oe("player-play","IconPlayerPlay",[["path",{d:"M7 4v16l13 -8z"}]]),Ee=oe("zoom-in-filled","IconZoomInFilled",[["path",{d:"M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-4 2.928a1 1 0 0 0 -.993 .883l-.007 .117v2h-2l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h2v2l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-2h2l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z","stroke-width":"0",fill:"currentColor"}]]),ke=oe("zoom-out-filled","IconZoomOutFilled",[["path",{d:"M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-1 5.928h-6l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h6l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z","stroke-width":"0",fill:"currentColor"}]]),At=E("<div>"),me=class{constructor(t){se(this,"x");se(this,"y");se(this,"width");se(this,"height");this.x=Math.floor(t.x),this.y=Math.floor(t.y),this.width=Math.floor(t.width),this.height=Math.floor(t.height)}get rect(){return{x:this.x,y:this.y,width:this.width,height:this.height}}get left(){return this.x}get top(){return this.y}get right(){return this.x+this.width}get bottom(){return this.y+this.height}get center(){return{x:this.x+this.width*.5,y:this.y+this.height*.5}}get corners(){return{topLeft:{x:this.left,y:this.top},topRight:{x:this.right,y:this.top},bottomRight:{x:this.left,y:this.bottom},bottomLeft:{x:this.right,y:this.bottom}}}},ne=t=>{let r=new me(t.getBoundingClientRect());const{transform:e}=getComputedStyle(t);return e&&(r=Et(r,e)),r},Et=(t,r)=>{let e,a;if(r.startsWith("matrix3d(")){const i=r.slice(9,-1).split(/, /);e=+i[12],a=+i[13]}else if(r.startsWith("matrix(")){const i=r.slice(7,-1).split(/, /);e=+i[4],a=+i[5]}else e=0,a=0;return new me({...t,x:t.x-e,y:t.y-a})},V=()=>({x:0,y:0}),Oe=(t,r)=>t.x===r.x&&t.y===r.y,Ie=(t,r)=>new me({...t,x:t.x+r.x,y:t.y+r.y}),kt=(t,r)=>Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),Nt=(t,r)=>{const e=Math.max(t.top,r.top),a=Math.max(t.left,r.left),i=Math.min(t.right,r.right),p=Math.min(t.bottom,r.bottom),v=i-a,u=p-e;if(a<i&&e<p){const l=t.width*t.height,h=r.width*r.height,g=v*u;return g/(l+h-g)}return 0},Ce=(t,r)=>t.x===r.x&&t.y===r.y&&t.width===r.width&&t.height===r.height,jt=(t,r,e)=>{const a=t.transformed.center,i={distance:1/0,droppable:null};for(const p of r){const v=kt(a,p.layout.center);v<i.distance?(i.distance=v,i.droppable=p):v===i.distance&&p.id===e.activeDroppableId&&(i.droppable=p)}return i.droppable},zt=(t,r,e)=>{const a=t.transformed,i={ratio:0,droppable:null};for(const p of r){const v=Nt(a,p.layout);v>i.ratio?(i.ratio=v,i.droppable=p):v>0&&v===i.ratio&&p.id===e.activeDroppableId&&(i.droppable=p)}return i.droppable},We=Ke(),Rt=t=>{const r=ze({collisionDetector:zt},t),[e,a]=Re({draggables:{},droppables:{},sensors:{},active:{draggableId:null,get draggable(){return e.active.draggableId!==null?e.draggables[e.active.draggableId]:null},droppableId:null,get droppable(){return e.active.droppableId!==null?e.droppables[e.active.droppableId]:null},sensorId:null,get sensor(){return e.active.sensorId!==null?e.sensors[e.active.sensorId]:null},overlay:null}}),i=(n,d,m)=>{n.substring(0,n.length-1),R(()=>e[n][d])&&a(n,d,"transformers",m.id,m)},p=(n,d,m)=>{n.substring(0,n.length-1),R(()=>e[n][d])&&R(()=>e[n][d].transformers[m])&&a(n,d,"transformers",m,void 0)},v=({id:n,node:d,layout:m,data:k})=>{const y=e.draggables[n],I={id:n,node:d,layout:m,data:k,_pendingCleanup:!1};let s;if(!y)Object.defineProperties(I,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{if(e.active.overlay)return V();const C=Object.values(e.draggables[n].transformers);return C.sort((x,z)=>x.order-z.order),C.reduce((x,z)=>z.callback(x),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>Ie(e.draggables[n].layout,e.draggables[n].transform)}});else if(e.active.draggableId===n&&!e.active.overlay){const C={x:y.layout.x-m.x,y:y.layout.y-m.y},x="addDraggable-existing-offset",z=y.transformers[x],K=z?z.callback(C):C;s={id:x,order:100,callback:j=>({x:j.x+K.x,y:j.y+K.y})},re(()=>p("draggables",n,x))}Z(()=>{a("draggables",n,I),s&&i("draggables",n,s)}),e.active.draggable&&A()},u=n=>{R(()=>e.draggables[n])&&(a("draggables",n,"_pendingCleanup",!0),queueMicrotask(()=>l(n)))},l=n=>{var d;if((d=e.draggables[n])!=null&&d._pendingCleanup){const m=e.active.draggableId===n;Z(()=>{m&&a("active","draggableId",null),a("draggables",n,void 0)})}},h=({id:n,node:d,layout:m,data:k})=>{const y=e.droppables[n],I={id:n,node:d,layout:m,data:k,_pendingCleanup:!1};y||Object.defineProperties(I,{transformers:{enumerable:!0,configurable:!0,writable:!0,value:{}},transform:{enumerable:!0,configurable:!0,get:()=>{const s=Object.values(e.droppables[n].transformers);return s.sort((C,x)=>C.order-x.order),s.reduce((C,x)=>x.callback(C),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>Ie(e.droppables[n].layout,e.droppables[n].transform)}}),a("droppables",n,I),e.active.draggable&&A()},g=n=>{R(()=>e.droppables[n])&&(a("droppables",n,"_pendingCleanup",!0),queueMicrotask(()=>$(n)))},$=n=>{var d;if((d=e.droppables[n])!=null&&d._pendingCleanup){const m=e.active.droppableId===n;Z(()=>{m&&a("active","droppableId",null),a("droppables",n,void 0)})}},_=({id:n,activators:d})=>{a("sensors",n,{id:n,activators:d,coordinates:{origin:{x:0,y:0},current:{x:0,y:0},get delta(){return{x:e.sensors[n].coordinates.current.x-e.sensors[n].coordinates.origin.x,y:e.sensors[n].coordinates.current.y-e.sensors[n].coordinates.origin.y}}}})},P=n=>{if(!R(()=>e.sensors[n]))return;const d=e.active.sensorId===n;Z(()=>{d&&a("active","sensorId",null),a("sensors",n,void 0)})},S=({node:n,layout:d})=>{const m=e.active.overlay,k={node:n,layout:d};m||Object.defineProperties(k,{id:{enumerable:!0,configurable:!0,get:()=>{var y;return(y=e.active.draggable)==null?void 0:y.id}},data:{enumerable:!0,configurable:!0,get:()=>{var y;return(y=e.active.draggable)==null?void 0:y.data}},transformers:{enumerable:!0,configurable:!0,get:()=>Object.fromEntries(Object.entries(e.active.draggable?e.active.draggable.transformers:{}).filter(([y])=>y!=="addDraggable-existing-offset"))},transform:{enumerable:!0,configurable:!0,get:()=>{const y=Object.values(e.active.overlay?e.active.overlay.transformers:[]);return y.sort((I,s)=>I.order-s.order),y.reduce((I,s)=>s.callback(I),V())}},transformed:{enumerable:!0,configurable:!0,get:()=>e.active.overlay?Ie(e.active.overlay.layout,e.active.overlay.transform):new me({x:0,y:0,width:0,height:0})}}),a("active","overlay",k)},O=()=>a("active","overlay",null),f=(n,d)=>{Z(()=>{a("sensors",n,"coordinates",{origin:{...d},current:{...d}}),a("active","sensorId",n)})},w=n=>{const d=e.active.sensorId;d&&a("sensors",d,"coordinates","current",{...n})},N=()=>a("active","sensorId",null),T=(n,d)=>{const m={};for(const y of Object.values(e.sensors))if(y)for(const[I,s]of Object.entries(y.activators))m[I]??(m[I]=[]),m[I].push({sensor:y,activator:s});const k={};for(const y in m){let I=y;d&&(I=`on${y}`),k[I]=s=>{for(const{activator:C}of m[y]){if(e.active.sensor)break;C(s,n)}}}return k},A=()=>{let n=!1;const d=Object.values(e.draggables),m=Object.values(e.droppables),k=e.active.overlay;return Z(()=>{const y=new WeakMap;for(const I of d)if(I){const s=I.layout;y.has(I.node)||y.set(I.node,ne(I.node));const C=y.get(I.node);Ce(s,C)||(a("draggables",I.id,"layout",C),n=!0)}for(const I of m)if(I){const s=I.layout;y.has(I.node)||y.set(I.node,ne(I.node));const C=y.get(I.node);Ce(s,C)||(a("droppables",I.id,"layout",C),n=!0)}if(k){const I=k.layout,s=ne(k.node);Ce(I,s)||(a("active","overlay","layout",s),n=!0)}}),n},M=()=>{const n=e.active.overlay??e.active.draggable;if(n){const d=r.collisionDetector(n,Object.values(e.droppables),{activeDroppableId:e.active.droppableId}),m=d?d.id:null;e.active.droppableId!==m&&a("active","droppableId",m)}},H=n=>{const d={id:"sensorMove",order:0,callback:m=>e.active.sensor?{x:m.x+e.active.sensor.coordinates.delta.x,y:m.y+e.active.sensor.coordinates.delta.y}:m};A(),Z(()=>{a("active","draggableId",n),i("draggables",n,d)}),M()},te=()=>{const n=R(()=>e.active.draggableId);Z(()=>{n!==null&&p("draggables",n,"sensorMove"),a("active",["draggableId","droppableId"],null)}),A()},o=n=>{G(()=>{const d=e.active.draggable;d&&R(()=>n({draggable:d}))})},D=n=>{G(()=>{const d=e.active.draggable;if(d){const m=R(()=>e.active.overlay);Object.values(m?m.transform:d.transform),R(()=>n({draggable:d,overlay:m}))}})},X=n=>{G(()=>{const d=e.active.draggable,m=e.active.droppable;d&&R(()=>n({draggable:d,droppable:m,overlay:e.active.overlay}))})},re=n=>{G(({previousDraggable:d,previousDroppable:m,previousOverlay:k})=>{const y=e.active.draggable,I=y?e.active.droppable:null,s=y?e.active.overlay:null;return!y&&d&&R(()=>n({draggable:d,droppable:m,overlay:k})),{previousDraggable:y,previousDroppable:I,previousOverlay:s}},{previousDraggable:null,previousDroppable:null,previousOverlay:null})};D(()=>M()),r.onDragStart&&o(r.onDragStart),r.onDragMove&&D(r.onDragMove),r.onDragOver&&X(r.onDragOver),r.onDragEnd&&re(r.onDragEnd);const pe=[e,{addTransformer:i,removeTransformer:p,addDraggable:v,removeDraggable:u,addDroppable:h,removeDroppable:g,addSensor:_,removeSensor:P,setOverlay:S,clearOverlay:O,recomputeLayouts:A,detectCollisions:M,draggableActivators:T,sensorStart:f,sensorMove:w,sensorEnd:N,dragStart:H,dragEnd:te,onDragStart:o,onDragMove:D,onDragOver:X,onDragEnd:re}];return c(We.Provider,{value:pe,get children(){return r.children}})},ee=()=>Ge(We)||null,Lt=(t="pointer-sensor")=>{const[r,{addSensor:e,removeSensor:a,sensorStart:i,sensorMove:p,sensorEnd:v,dragStart:u,dragEnd:l}]=ee(),h=250,g=10;be(()=>{e({id:t,activators:{pointerdown:O}})}),ce(()=>{a(t)});const $=()=>r.active.sensorId===t,_={x:0,y:0};let P=null,S=null;const O=(M,H)=>{M.button===0&&(document.addEventListener("pointermove",N),document.addEventListener("pointerup",T),S=H,_.x=M.clientX,_.y=M.clientY,P=window.setTimeout(w,h))},f=()=>{P&&(clearTimeout(P),P=null),document.removeEventListener("pointermove",N),document.removeEventListener("pointerup",T),document.removeEventListener("selectionchange",A)},w=()=>{r.active.sensor?$()||f():(i(t,_),u(S),A(),document.addEventListener("selectionchange",A))},N=M=>{const H={x:M.clientX,y:M.clientY};if(!r.active.sensor){const te={x:H.x-_.x,y:H.y-_.y};Math.sqrt(te.x**2+te.y**2)>g&&w()}$()&&(M.preventDefault(),p(H))},T=M=>{f(),$()&&(M.preventDefault(),l(),v())},A=()=>{var M;(M=window.getSelection())==null||M.removeAllRanges()}},Kt=t=>(Lt(),q(()=>t.children)),de=t=>({transform:`translate3d(${t.x}px, ${t.y}px, 0)`}),Gt=(t,r={})=>{const[e,{addDraggable:a,removeDraggable:i,draggableActivators:p}]=ee(),[v,u]=W(null);be(()=>{const $=v();$&&a({id:t,node:$,layout:ne($),data:r})}),ce(()=>i(t));const l=()=>e.active.draggableId===t,h=()=>{var $;return(($=e.draggables[t])==null?void 0:$.transform)||V()};return Object.defineProperties(($,_)=>{const P=_?_():{};G(()=>{const S=v(),O=p(t);if(S)for(const f in O)S.addEventListener(f,O[f]);ce(()=>{if(S)for(const f in O)S.removeEventListener(f,O[f])})}),u($),P.skipTransform||G(()=>{const S=h();if(Oe(S,V()))$.style.removeProperty("transform");else{const O=de(h());$.style.setProperty("transform",O.transform??null)}})},{ref:{enumerable:!0,value:u},isActiveDraggable:{enumerable:!0,get:l},dragActivators:{enumerable:!0,get:()=>p(t,!0)},transform:{enumerable:!0,get:h}})},Vt=(t,r={})=>{const[e,{addDroppable:a,removeDroppable:i}]=ee(),[p,v]=W(null);be(()=>{const g=p();g&&a({id:t,node:g,layout:ne(g),data:r})}),ce(()=>i(t));const u=()=>e.active.droppableId===t,l=()=>{var g;return((g=e.droppables[t])==null?void 0:g.transform)||V()};return Object.defineProperties((g,$)=>{const _=$?$():{};v(g),_.skipTransform||G(()=>{const P=l();if(Oe(P,V()))g.style.removeProperty("transform");else{const S=de(l());g.style.setProperty("transform",S.transform??null)}})},{ref:{enumerable:!0,value:v},isActiveDroppable:{enumerable:!0,get:u},transform:{enumerable:!0,get:l}})},qt=t=>{const[r,{onDragStart:e,onDragEnd:a,setOverlay:i,clearOverlay:p}]=ee();let v;e(({draggable:l})=>{i({node:l.node,layout:l.layout}),queueMicrotask(()=>{if(v){const h=ne(v),g={x:(l.layout.width-h.width)/2,y:(l.layout.height-h.height)/2};h.x+=g.x,h.y+=g.y,i({node:v,layout:h})}})}),a(()=>queueMicrotask(p));const u=()=>{const l=r.active.overlay,h=r.active.draggable;return!l||!h?{}:{position:"fixed",transition:"transform 0s",top:`${l.layout.top}px`,left:`${l.layout.left}px`,"min-width":`${h.layout.width}px`,"min-height":`${h.layout.height}px`,...de(l.transform),...t.style}};return c(et,{get mount(){return document.body},get children(){return c(_e,{get when(){return r.active.draggable},get children(){var l=At(),h=v;return typeof h=="function"?De(h,l):v=l,b(l,(()=>{var g=q(()=>typeof t.children=="function");return()=>g()?t.children(r.active.draggable):t.children})()),B(g=>{var $=t.class,_=u();return $!==g.e&&ae(l,g.e=$),g.t=Le(l,_,g.t),g},{e:void 0,t:void 0}),l}})}})},Bt=(t,r,e)=>{const a=t.slice();return a.splice(e,0,...a.splice(r,1)),a},Ye=Ke(),Ht=t=>{const[r]=ee(),[e,a]=Re({initialIds:[],sortedIds:[]}),i=u=>u>=0&&u<e.initialIds.length;G(()=>{a("initialIds",[...t.ids]),a("sortedIds",[...t.ids])}),G(()=>{r.active.draggableId&&r.active.droppableId?R(()=>{const u=e.sortedIds.indexOf(r.active.draggableId),l=e.initialIds.indexOf(r.active.droppableId);if(!i(u)||!i(l))a("sortedIds",[...t.ids]);else if(u!==l){const h=Bt(e.sortedIds,u,l);a("sortedIds",h)}}):a("sortedIds",[...t.ids])});const v=[e,{}];return c(Ye.Provider,{value:v,get children(){return t.children}})},Ut=()=>Ge(Ye)||null,Wt=(t,r)=>e=>{t(e),r(e)},Yt=(t,r={})=>{const[e,{addTransformer:a,removeTransformer:i}]=ee(),[p]=Ut(),v=Gt(t,r),u=Vt(t,r),l=Wt(v.ref,u.ref),h=()=>p.initialIds.indexOf(t),g=()=>p.sortedIds.indexOf(t),$=f=>{var w;return((w=e.droppables[f])==null?void 0:w.layout)||null},_=()=>{const f=V(),w=h(),N=g();if(N!==w){const T=$(t),A=$(p.initialIds[N]);T&&A&&(f.x=A.x-T.x,f.y=A.y-T.y)}return f},P={id:"sortableOffset",order:100,callback:f=>{const w=_();return{x:f.x+w.x,y:f.y+w.y}}};be(()=>a("droppables",t,P)),ce(()=>i("droppables",t,P.id));const S=()=>{var f,w;return(t===e.active.draggableId&&!e.active.overlay?(f=e.draggables[t])==null?void 0:f.transform:(w=e.droppables[t])==null?void 0:w.transform)||V()};return Object.defineProperties(f=>{v(f,()=>({skipTransform:!0})),u(f,()=>({skipTransform:!0})),G(()=>{const w=S();if(Oe(w,V()))f.style.removeProperty("transform");else{const N=de(S());f.style.setProperty("transform",N.transform??null)}})},{ref:{enumerable:!0,value:l},transform:{enumerable:!0,get:S},isActiveDraggable:{enumerable:!0,get:()=>v.isActiveDraggable},dragActivators:{enumerable:!0,get:()=>v.dragActivators},isActiveDroppable:{enumerable:!0,get:()=>u.isActiveDroppable}})},Zt=E('<form><div class="join flex"><select name=sourceIP class="join-item select select-bordered"><option></option></select><input name=tagName class="input join-item input-bordered min-w-0 flex-1"placeholder=name>'),Xt=E("<option class=badge>"),Jt=E('<div><div class="flex justify-between py-2"><div class="flex items-center gap-2"><span></span></div><input type=checkbox class=toggle>'),Qt=E("<div>"),er=E('<div class="flex flex-col gap-4"><div><select class="select select-bordered w-full"></select></div><div><div class="flex flex-col gap-4"><div class="flex flex-col gap-2"></div></div></div><div>'),tr=E("<option>"),rr=E('<div class="badge badge-primary w-full items-center justify-between gap-2 py-4"><span class=truncate> (<!>)');const ar=()=>{const t=ye.object({tagName:ye.string().nonempty(),sourceIP:ye.string().nonempty()}),[r]=fe(),{form:e,reset:a}=Dt({extend:wt({schema:t}),onSubmit:({tagName:i,sourceIP:p})=>{qe(v=>v.some(u=>u.tagName===i||u.sourceIP===p)?v:[...v,{tagName:i,sourceIP:p}]),a()}});return(()=>{var i=Zt(),p=i.firstChild,v=p.firstChild;return v.firstChild,v.nextSibling,De(e,i,()=>e),b(v,c(Se,{get each(){return Ue.uniq(we().map(({metadata:{sourceIP:u}})=>u)).sort().filter(u=>!ie().some(({sourceIP:l})=>l===u))},children:u=>(()=>{var l=Xt();return b(l,u),B(()=>l.value=u()),l})()}),null),b(p,c(Y,{type:"submit",class:"join-item",get children(){return r("tag")}}),null),i})()},nr=t=>{const[r]=fe(),[e,a]=W(null),i=({draggable:u})=>a(u.id),p=({draggable:u,droppable:l})=>{if(u&&l){const h=t.order,g=h.indexOf(u.id),$=h.indexOf(l.id);if(g!==$){const _=h.slice();_.splice($,0,..._.splice(g,1)),t.onOrderChange(_)}}},v=({key:u})=>{const l=Yt(u),[h]=ee();return(()=>{var g=Jt(),$=g.firstChild,_=$.firstChild,P=_.firstChild,S=_.nextSibling,O=l.ref;return typeof O=="function"?De(O,g):l.ref=g,b(_,c(Y,ze({class:"btn-ghost btn-sm cursor-grab",get icon(){return c(Pt,{size:24})}},()=>l.dragActivators)),P),b(P,()=>r(u)),S.addEventListener("change",f=>{t.onVisibleChange({...t.visible,[u]:f.target.checked})}),B(f=>{var w=!!l.isActiveDraggable,N=!!h.active.draggable,T=de(l.transform);return w!==f.e&&g.classList.toggle("opacity-25",f.e=w),N!==f.t&&g.classList.toggle("transition-transform",f.t=N),f.a=Le(g,T,f.a),f},{e:void 0,t:void 0,a:void 0}),B(()=>S.checked=t.visible[u]),g})()};return c(He,{ref:u=>{var l;return(l=t.ref)==null?void 0:l.call(t,u)},get icon(){return c(Ve,{size:24})},get title(){return r("connectionsSettings")},get action(){return c(Y,{class:"btn-neutral btn-sm",onClick:()=>{t.onOrderChange(tt),t.onVisibleChange(rt)},get children(){return r("reset")}})},get children(){var u=er(),l=u.firstChild,h=l.firstChild,g=l.nextSibling,$=g.firstChild,_=$.firstChild,P=g.nextSibling;return b(l,c(xe,{withDivider:!0,get children(){return r("tableSize")}}),h),h.addEventListener("change",S=>at(S.target.value)),b(h,c(Q,{get each(){return Object.values(nt)},children:S=>(()=>{var O=tr();return O.value=S,b(O,()=>r(S)),O})()})),b(g,c(xe,{withDivider:!0,get children(){return r("tagClientSourceIPWithName")}}),$),b($,c(ar,{}),_),b(_,c(Q,{get each(){return ie()},children:({tagName:S,sourceIP:O})=>(()=>{var f=rr(),w=f.firstChild,N=w.firstChild,T=N.nextSibling;return T.nextSibling,b(w,S,N),b(w,O,T),b(f,c(Y,{class:"btn-circle btn-ghost btn-xs",onClick:()=>qe(A=>A.filter(M=>M.tagName!==S)),get icon(){return c($e,{size:12})}}),null),f})()})),b(P,c(xe,{withDivider:!0,get children(){return r("sort")}}),null),b(P,c(Rt,{onDragStart:i,onDragEnd:p,collisionDetector:jt,get children(){return[c(Kt,{}),c(Ht,{get ids(){return t.order},get children(){return c(Q,{get each(){return t.order},children:S=>c(v,{key:S})})}}),c(qt,{get children(){return c(_e,{get when(){return e()},get children(){var S=Qt();return b(S,()=>r(e())),S}})}})]}}),null),B(()=>h.value=Be()),u}})};var or=E("<pre><code>");const sr=t=>{const[r]=fe();return c(He,{ref:e=>{var a;return(a=t.ref)==null?void 0:a.call(t,e)},get icon(){return c(Ve,{size:24})},get title(){return r("connectionsDetails")},get children(){return c(_e,{get when(){return t.selectedConnectionID},get children(){var e=or(),a=e.firstChild;return b(a,()=>JSON.stringify(we().find(({id:i})=>i===t.selectedConnectionID),null,2)),e}})}})};var lr=async t=>{typeof t=="string"?await navigator.clipboard.writeText(t):await navigator.clipboard.write(t)},Ne=E('<div class="flex h-4 items-center">'),ir=E('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><select class="select select-bordered select-primary select-sm w-full max-w-full flex-1 sm:select-md"><option value=""></option></select></div><div class="join flex flex-1 items-center md:flex-1"><input type=search class="input input-sm join-item input-primary min-w-0 flex-1 sm:input-md"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),cr=E('<button><span></span><div class="badge badge-sm">'),dr=E("<option>"),ur=E("<tr>"),gr=E("<th class=bg-base-200><div><div>"),vr=E("<button class=cursor-pointer>"),br=E('<tr class="hover:!bg-primary hover:text-primary-content">'),fr=E("<td class=py-2>"),mr=E("<button><div></div><div></div><div>(<!>)");const je=(t,r,e,a)=>{const i=_t(t.getValue(r),e);return a({itemRank:i}),i.passed},$r=()=>{const t=ot();if(!st())return t("/setup",{replace:!0}),null;let r,e;const[a]=fe(),[i,p]=W(0),{activeConnections:v,closedConnections:u,paused:l,setPaused:h}=lt(),[g,$]=W(""),[_,P]=W(),S=[{header:()=>a("details"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:F.Details,cell:({row:o})=>(()=>{var D=Ne();return b(D,c(Y,{class:"btn-circle btn-xs",onClick:()=>{P(o.original.id),e==null||e.showModal()},get icon(){return c(Mt,{size:"16"})}})),D})()},{header:()=>a("close"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:F.Close,cell:({row:o})=>(()=>{var D=Ne();return b(D,c(Y,{class:"btn-circle btn-xs",onClick:()=>Pe(o.original.id),get icon(){return c($e,{size:"16"})}})),D})()},{header:()=>a("ID"),enableGrouping:!1,accessorKey:F.ID,accessorFn:o=>o.id},{header:()=>a("type"),accessorKey:F.Type,accessorFn:o=>`${o.metadata.type}(${o.metadata.network})`},{header:()=>a("process"),accessorKey:F.Process,accessorFn:o=>o.metadata.process||o.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>a("host"),accessorKey:F.Host,accessorFn:o=>`${o.metadata.host?o.metadata.host:o.metadata.destinationIP}:${o.metadata.destinationPort}`},{header:()=>a("sniffHost"),accessorKey:F.SniffHost,accessorFn:o=>o.metadata.sniffHost||"-"},{header:()=>a("rules"),accessorKey:F.Rule,accessorFn:o=>o.rulePayload?`${o.rule} :: ${o.rulePayload}`:o.rule},{header:()=>a("chains"),accessorKey:F.Chains,accessorFn:o=>o.chains.slice().reverse().join(" :: ")},{header:()=>a("connectTime"),enableGrouping:!1,accessorKey:F.ConnectTime,accessorFn:o=>Ot(o.start),sortingFn:(o,D)=>Fe(o.original.start).valueOf()-Fe(D.original.start).valueOf()},{header:()=>a("dlSpeed"),enableGrouping:!1,accessorKey:F.DlSpeed,accessorFn:o=>`${ge(o.downloadSpeed)}/s`,sortingFn:(o,D)=>o.original.downloadSpeed-D.original.downloadSpeed},{header:()=>a("ulSpeed"),enableGrouping:!1,accessorKey:F.ULSpeed,accessorFn:o=>`${ge(o.uploadSpeed)}/s`,sortingFn:(o,D)=>o.original.uploadSpeed-D.original.uploadSpeed},{header:()=>a("dl"),enableGrouping:!1,accessorKey:F.Download,accessorFn:o=>ge(o.download),sortingFn:(o,D)=>o.original.download-D.original.download},{header:()=>a("ul"),enableGrouping:!1,accessorKey:F.Upload,accessorFn:o=>ge(o.upload),sortingFn:(o,D)=>o.original.upload-D.original.upload},{header:()=>a("sourceIP"),accessorKey:F.SourceIP,accessorFn:o=>{const D=ie().find(X=>X.sourceIP===o.metadata.sourceIP);return D?D.tagName:o.metadata.sourceIP}},{header:()=>a("sourcePort"),accessorKey:F.SourcePort,accessorFn:o=>o.metadata.sourcePort},{header:()=>a("destination"),accessorKey:F.Destination,accessorFn:o=>o.metadata.remoteDestination||o.metadata.destinationIP||o.metadata.host},{header:()=>a("inboundUser"),accessorKey:F.InboundUser,accessorFn:o=>o.metadata.inboundUser||o.metadata.inboundName||o.metadata.inboundPort}],[O,f]=W([]),[w,N]=it(W([{id:F.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),T=pt({filterFns:{fuzzy:je},state:{get columnOrder(){return Te()},get grouping(){return O()},get sorting(){return w()},get columnVisibility(){return Ae()},get globalFilter(){return g()}},get data(){return i()===0?v():u()},sortDescFirst:!0,enableHiding:!0,columns:S,onGlobalFilterChange:$,globalFilterFn:je,onGroupingChange:f,onSortingChange:N,getFilteredRowModel:ht(),getSortedRowModel:yt(),getExpandedRowModel:xt(),getGroupedRowModel:It(),getCoreRowModel:Ct()}),A=T.getFlatHeaders().find(({id:o})=>o===F.SourceIP),[M,H]=W("");G(ct(M,()=>{const o=ie().find(D=>D.sourceIP===M());A==null||A.column.setFilterValue(o?o.tagName:M())}));const te=q(()=>[{type:0,name:a("active"),count:v().length},{type:1,name:a("closed"),count:u().length}]);return(()=>{var o=ir(),D=o.firstChild,X=D.firstChild,re=X.firstChild,ue=re.nextSibling,pe=ue.firstChild,n=X.nextSibling,d=n.firstChild,m=D.nextSibling,k=m.firstChild,y=k.firstChild,I=y.nextSibling;return b(re,c(Se,{get each(){return te()},children:s=>(()=>{var C=cr(),x=C.firstChild,z=x.nextSibling;return C.$$click=()=>p(s().type),b(x,()=>s().name),b(z,()=>s().count),B(()=>ae(C,le(i()===s().type&&"tab-active","tab-sm sm:tab-md tab gap-2"))),C})()})),ue.addEventListener("change",s=>H(s.target.value)),b(pe,()=>a("all")),b(ue,c(Se,{get each(){return Ue.uniq(we().map(({metadata:{sourceIP:s}})=>{const C=ie().find(x=>x.sourceIP===s);return C?C.tagName:s})).sort()},children:s=>(()=>{var C=dr();return b(C,s),B(()=>C.value=s()),C})()}),null),d.$$input=s=>$(s.target.value),b(n,c(Y,{class:"join-item btn-sm sm:btn-md",onClick:()=>h(s=>!s),get icon(){return q(()=>!!l())()?c(Tt,{}):c(Ft,{})}}),null),b(n,c(Y,{class:"join-item btn-sm sm:btn-md",onClick:()=>{T.getState().globalFilter?T.getFilteredRowModel().rows.forEach(({original:s})=>Pe(s.id)):dt()},get icon(){return c($e,{})}}),null),b(n,c(Y,{class:"btn join-item btn-sm sm:btn-md",onClick:()=>r==null?void 0:r.showModal(),get icon(){return c(ut,{})}}),null),b(y,c(Q,{get each(){return T.getHeaderGroups()},children:s=>(()=>{var C=ur();return b(C,c(Q,{get each(){return s.headers},children:x=>(()=>{var z=gr(),K=z.firstChild,j=K.firstChild;return b(K,(()=>{var L=q(()=>!!x.column.getCanGroup());return()=>L()?(()=>{var U=vr();return he(U,"click",x.column.getToggleGroupingHandler(),!0),b(U,(()=>{var J=q(()=>!!x.column.getIsGrouped());return()=>J()?c(ke,{size:18}):c(Ee,{size:18})})()),U})():null})(),j),he(j,"click",x.column.getToggleSortingHandler(),!0),b(j,()=>ve(x.column.columnDef.header,x.getContext())),b(K,()=>({asc:c($t,{}),desc:c(St,{})})[x.column.getIsSorted()]??null,null),B(L=>{var U=le("flex items-center gap-2"),J=le(x.column.getCanSort()&&"cursor-pointer select-none","flex-1");return U!==L.e&&ae(K,L.e=U),J!==L.t&&ae(j,L.t=J),L},{e:void 0,t:void 0}),z})()})),C})()})),b(I,c(Q,{get each(){return T.getRowModel().rows},children:s=>(()=>{var C=br();return b(C,c(Q,{get each(){return s.getVisibleCells()},children:x=>(()=>{var z=fr();return z.$$contextmenu=K=>{K.preventDefault();const j=x.renderValue();j&&lr(j).catch(()=>{})},b(z,(()=>{var K=q(()=>!!x.getIsGrouped());return()=>K()?(()=>{var j=mr(),L=j.firstChild,U=L.nextSibling,J=U.nextSibling,Ze=J.firstChild,Me=Ze.nextSibling;return Me.nextSibling,he(j,"click",s.getToggleExpandedHandler(),!0),b(L,(()=>{var Xe=q(()=>!!s.getIsExpanded());return()=>Xe()?c(ke,{size:18}):c(Ee,{size:18})})()),b(U,()=>ve(x.column.columnDef.cell,x.getContext())),b(J,()=>s.subRows.length,Me),B(()=>ae(j,le(s.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),j})():(()=>{var j=q(()=>!!x.getIsAggregated());return()=>j()?ve(x.column.columnDef.aggregatedCell??x.column.columnDef.cell,x.getContext()):(()=>{var L=q(()=>!!x.getIsPlaceholder());return()=>L()?null:ve(x.column.columnDef.cell,x.getContext())})()})()})()),z})()})),C})()})),b(o,c(nr,{ref:s=>r=s,get order(){return Te()},get visible(){return Ae()},onOrderChange:s=>gt(s),onVisibleChange:s=>vt({...s})}),null),b(o,c(sr,{ref:s=>e=s,get selectedConnectionID(){return _()}}),null),B(s=>{var C=a("search"),x=le(bt(Be()),"table table-zebra relative rounded-none");return C!==s.e&&ft(d,"placeholder",s.e=C),x!==s.t&&ae(k,s.t=x),s},{e:void 0,t:void 0}),o})()};mt(["input","click","contextmenu"]);export{$r as default};
